<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ title if title else "Yipoodle Operator UI" }}</title>
    <link rel="stylesheet" href="/static/style.css" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ”¬</text></svg>"
    />
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
  </head>
  <body>
    <header>
      <div class="header-brand">
        <span class="brand-icon">ðŸ”¬</span>
        <h1>Yipoodle</h1>
        <span class="brand-tag">Operator UI</span>
      </div>
      <nav>
        <a
          href="/"
          class="nav-link {% if request.url.path == '/' %}active{% endif %}"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
            />
          </svg>
          Chat
        </a>
        <a
          href="/run-console"
          class="nav-link {% if request.url.path == '/run-console' %}active{% endif %}"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polygon points="5 3 19 12 5 21 5 3" />
          </svg>
          Run
        </a>
        <a
          href="/runs"
          class="nav-link {% if '/runs' in request.url.path %}active{% endif %}"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="3" y="3" width="7" height="7" />
            <rect x="14" y="3" width="7" height="7" />
            <rect x="14" y="14" width="7" height="7" />
            <rect x="3" y="14" width="7" height="7" />
          </svg>
          Runs
        </a>
        <a
          href="/monitor"
          class="nav-link {% if request.url.path == '/monitor' %}active{% endif %}"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
          </svg>
          Monitor
        </a>
        <a
          href="/health"
          class="nav-link {% if request.url.path == '/health' %}active{% endif %}"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
            <circle cx="12" cy="12" r="10" stroke-dasharray="4 4" />
          </svg>
          Health
        </a>
        <a
          href="/api/v1/docs"
          target="_blank"
          rel="noreferrer"
          class="nav-link"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
            />
            <polyline points="14 2 14 8 20 8" />
          </svg>
          API
        </a>
      </nav>
      <button
        id="theme-toggle"
        class="theme-toggle"
        type="button"
        title="Toggle theme"
      >
        <svg
          class="icon-sun"
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <circle cx="12" cy="12" r="5" />
          <line x1="12" y1="1" x2="12" y2="3" />
          <line x1="12" y1="21" x2="12" y2="23" />
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
          <line x1="1" y1="12" x2="3" y2="12" />
          <line x1="21" y1="12" x2="23" y2="12" />
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
        </svg>
        <svg
          class="icon-moon"
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
        </svg>
      </button>
    </header>
    <main>{% block content %}{% endblock %}</main>
    <footer>
      <span>Yipoodle Research Copilot</span>
      <span class="footer-sep">Â·</span>
      <span class="muted">Offline-first deterministic pipeline</span>
    </footer>
    <script>
      (function () {
        const toggle = document.getElementById("theme-toggle");
        const html = document.documentElement;
        const stored = localStorage.getItem("yipoodle-theme");
        if (stored) html.setAttribute("data-theme", stored);
        toggle.addEventListener("click", () => {
          const next =
            html.getAttribute("data-theme") === "dark" ? "light" : "dark";
          html.setAttribute("data-theme", next);
          localStorage.setItem("yipoodle-theme", next);
        });
      })();
    </script>
  </body>
</html>
